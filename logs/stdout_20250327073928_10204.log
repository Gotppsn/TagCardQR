info: Program[0]
      Using PathBase: /tagcardqr
info: Program[0]
      Running in Development mode
info: Program[0]
      Default Controller: Card, Default Action: Index
info: Program[0]
      Application Root Path: C:\Users\panupol\Desktop\TagCardQR
info: Microsoft.Hosting.Lifetime[0]
      Application started. Press Ctrl+C to shut down.
info: Microsoft.Hosting.Lifetime[0]
      Hosting environment: Development
info: Microsoft.Hosting.Lifetime[0]
      Content root path: C:\Users\panupol\Desktop\TagCardQR
warn: Microsoft.EntityFrameworkCore.Model.Validation[10400]
      Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (50ms) [Parameters=[@__username_0='admin' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (18ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      ORDER BY [c].[UpdatedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (11ms) [Parameters=[@__p_0='13'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (13ms) [Parameters=[@__cardId_0='13'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [s].[Id], [s].[CardId], [s].[CreatedAt], [s].[CreatedBy], [s].[FieldsJson], [s].[PrivateMode], [s].[UiElementsJson], [s].[UpdatedAt]
      FROM [ScanSettings] AS [s]
      WHERE [s].[CardId] = @__cardId_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (15ms) [Parameters=[@__cardId_0='13'], CommandType='Text', CommandTimeout='120']
      SELECT [m].[Id], [m].[CardId], [m].[CreatedAt], [m].[CreatedBy], [m].[DueDate], [m].[Notes], [m].[RepeatFrequency], [m].[Title], [m].[UpdatedAt]
      FROM [MaintenanceReminders] AS [m]
      WHERE [m].[CardId] = @__cardId_0
      ORDER BY [m].[DueDate]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[@__cardId_0='13'], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[CardId], [c].[Description], [c].[DocumentType], [c].[FileName], [c].[FilePath], [c].[FileSize], [c].[FileType], [c].[Title], [c].[UploadedAt], [c].[UploadedBy]
      FROM [CardDocuments] AS [c]
      WHERE [c].[CardId] = @__cardId_0
      ORDER BY [c].[UploadedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__username_0='admin' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      ORDER BY [c].[UpdatedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[CreatedAt], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[UpdatedAt]
      FROM [Roles] AS [r]
      ORDER BY [r].[Name]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (10ms) [Parameters=[@__username_0='admin' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      ORDER BY [c].[UpdatedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__p_0='100'], CommandType='Text', CommandTimeout='120']
      SELECT [s0].[Id], [s0].[CardId], [c].[ProductName] AS [CardName], [s0].[ScanTime], [s0].[DeviceInfo], [s0].[Location], [s0].[Result] AS [ScanResult]
      FROM (
          SELECT TOP(@__p_0) [s].[Id], [s].[CardId], [s].[DeviceInfo], [s].[Location], [s].[Result], [s].[ScanTime]
          FROM [ScanResults] AS [s]
          ORDER BY [s].[ScanTime] DESC
      ) AS [s0]
      INNER JOIN [Cards] AS [c] ON [s0].[CardId] = [c].[Id]
      ORDER BY [s0].[ScanTime] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[@__p_0='100'], CommandType='Text', CommandTimeout='120']
      SELECT [s0].[Id], [s0].[CardId], [c].[ProductName] AS [CardName], [s0].[ScanTime], [s0].[DeviceInfo], [s0].[Location], [s0].[Result] AS [ScanResult]
      FROM (
          SELECT TOP(@__p_0) [s].[Id], [s].[CardId], [s].[DeviceInfo], [s].[Location], [s].[Result], [s].[ScanTime]
          FROM [ScanResults] AS [s]
          ORDER BY [s].[ScanTime] DESC
      ) AS [s0]
      INNER JOIN [Cards] AS [c] ON [s0].[CardId] = [c].[Id]
      ORDER BY [s0].[ScanTime] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (10ms) [Parameters=[@__username_0='admin' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      ORDER BY [c].[UpdatedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [d].[Id], [d].[DepartmentName], [d].[GrantedAt], [d].[GrantedBy], [d].[GrantedById], [d].[IsActive], [d].[UserId], [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [DepartmentAccesses] AS [d]
      INNER JOIN [UserProfiles] AS [u] ON [d].[UserId] = [u].[Id]
      ORDER BY [d].[DepartmentName], [u].[Username]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      ORDER BY [u].[Username]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[CreatedAt], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[UpdatedAt]
      FROM [Roles] AS [r]
      ORDER BY [r].[Name]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[@__userId_0='18'], CommandType='Text', CommandTimeout='120']
      SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[CreatedAt], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[UpdatedAt]
      FROM [UserRoles] AS [u]
      INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
      WHERE [u].[UserId] = @__userId_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[@__userId_0='19'], CommandType='Text', CommandTimeout='120']
      SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[CreatedAt], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[UpdatedAt]
      FROM [UserRoles] AS [u]
      INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
      WHERE [u].[UserId] = @__userId_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[@__userId_0='16'], CommandType='Text', CommandTimeout='120']
      SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[CreatedAt], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[UpdatedAt]
      FROM [UserRoles] AS [u]
      INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
      WHERE [u].[UserId] = @__userId_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[@__p_0='100'], CommandType='Text', CommandTimeout='120']
      SELECT [s0].[Id], [s0].[CardId], [c].[ProductName] AS [CardName], [s0].[ScanTime], [s0].[DeviceInfo], [s0].[Location], [s0].[Result] AS [ScanResult]
      FROM (
          SELECT TOP(@__p_0) [s].[Id], [s].[CardId], [s].[DeviceInfo], [s].[Location], [s].[Result], [s].[ScanTime]
          FROM [ScanResults] AS [s]
          ORDER BY [s].[ScanTime] DESC
      ) AS [s0]
      INNER JOIN [Cards] AS [c] ON [s0].[CardId] = [c].[Id]
      ORDER BY [s0].[ScanTime] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__p_0='100'], CommandType='Text', CommandTimeout='120']
      SELECT [s0].[Id], [s0].[CardId], [c].[ProductName] AS [CardName], [s0].[ScanTime], [s0].[DeviceInfo], [s0].[Location], [s0].[Result] AS [ScanResult]
      FROM (
          SELECT TOP(@__p_0) [s].[Id], [s].[CardId], [s].[DeviceInfo], [s].[Location], [s].[Result], [s].[ScanTime]
          FROM [ScanResults] AS [s]
          ORDER BY [s].[ScanTime] DESC
      ) AS [s0]
      INNER JOIN [Cards] AS [c] ON [s0].[CardId] = [c].[Id]
      ORDER BY [s0].[ScanTime] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[CreatedAt], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[UpdatedAt]
      FROM [Roles] AS [r]
      ORDER BY [r].[Name]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[@__username_0='admin' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      ORDER BY [c].[UpdatedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t0].[Category]
      FROM (
          SELECT DISTINCT [t].[Category]
          FROM [Templates] AS [t]
      ) AS [t0]
      ORDER BY [t0].[Category]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[@__p_0='4'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
      WHERE [t].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (17ms) [Parameters=[@__p_0='5'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
      WHERE [t].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__username_0='admin' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      ORDER BY [c].[UpdatedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[@__p_0='13'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (11ms) [Parameters=[@__p_1='10', @__8__locals1_id_0='13'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(@__p_1) [c].[Id], [c].[CardId], [c].[ChangedAt], [c].[ChangedBy], [c].[FieldName], [c].[NewValue], [c].[OldValue]
      FROM [CardHistories] AS [c]
      WHERE [c].[CardId] = @__8__locals1_id_0
      ORDER BY [c].[ChangedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__p_0='5'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
      WHERE [t].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t0].[Category]
      FROM (
          SELECT DISTINCT [t].[Category]
          FROM [Templates] AS [t]
      ) AS [t0]
      ORDER BY [t0].[Category]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (9ms) [Parameters=[@__p_0='5'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
      WHERE [t].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[@__username_0='admin' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      ORDER BY [c].[UpdatedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[@__p_0='14'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__username_0='admin' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      ORDER BY [c].[UpdatedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (12ms) [Parameters=[@__p_0='14'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[@__p_1='10', @__8__locals1_id_0='14'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(@__p_1) [c].[Id], [c].[CardId], [c].[ChangedAt], [c].[ChangedBy], [c].[FieldName], [c].[NewValue], [c].[OldValue]
      FROM [CardHistories] AS [c]
      WHERE [c].[CardId] = @__8__locals1_id_0
      ORDER BY [c].[ChangedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__p_0='5'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
      WHERE [t].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t0].[Category]
      FROM (
          SELECT DISTINCT [t].[Category]
          FROM [Templates] AS [t]
      ) AS [t0]
      ORDER BY [t0].[Category]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__p_0='5'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
      WHERE [t].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[@__username_0='admin' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      ORDER BY [c].[UpdatedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[@__p_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__cardId_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[CardId], [c].[Description], [c].[DocumentType], [c].[FileName], [c].[FilePath], [c].[FileSize], [c].[FileType], [c].[Title], [c].[UploadedAt], [c].[UploadedBy]
      FROM [CardDocuments] AS [c]
      WHERE [c].[CardId] = @__cardId_0
      ORDER BY [c].[UploadedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__cardId_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [s].[Id], [s].[CardId], [s].[CreatedAt], [s].[CreatedBy], [s].[FieldsJson], [s].[PrivateMode], [s].[UiElementsJson], [s].[UpdatedAt]
      FROM [ScanSettings] AS [s]
      WHERE [s].[CardId] = @__cardId_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (34ms) [Parameters=[@__cardId_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT [m].[Id], [m].[CardId], [m].[CreatedAt], [m].[CreatedBy], [m].[DueDate], [m].[Notes], [m].[RepeatFrequency], [m].[Title], [m].[UpdatedAt]
      FROM [MaintenanceReminders] AS [m]
      WHERE [m].[CardId] = @__cardId_0
      ORDER BY [m].[DueDate]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[@__p_1='20', @__8__locals1_id_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(@__p_1) [c].[Id], [c].[CardId], [c].[ChangedAt], [c].[ChangedBy], [c].[FieldName], [c].[NewValue], [c].[OldValue]
      FROM [CardHistories] AS [c]
      WHERE [c].[CardId] = @__8__locals1_id_0
      ORDER BY [c].[ChangedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__cardId_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[CardId], [c].[Description], [c].[DocumentType], [c].[FileName], [c].[FilePath], [c].[FileSize], [c].[FileType], [c].[Title], [c].[UploadedAt], [c].[UploadedBy]
      FROM [CardDocuments] AS [c]
      WHERE [c].[CardId] = @__cardId_0
      ORDER BY [c].[UploadedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (16ms) [Parameters=[@__p_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (514ms) [Parameters=[@p0='11', @p1='Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 | "Windows"' (Nullable = false) (Size = 255), @p2='::1' (Nullable = false) (Size = 100), @p3='False', @p4='https://localhost:44389/Card/Details/11' (Nullable = false) (Size = 255), @p5=NULL (DbType = Int32), @p6='Success' (Nullable = false) (Size = 50), @p7='Regular' (Nullable = false) (Size = 50), @p8='' (Nullable = false) (Size = 100), @p9='2025-03-27T14:40:50.3656471+07:00', @p10='admin' (Nullable = false) (Size = 50)], CommandType='Text', CommandTimeout='120']
      SET IMPLICIT_TRANSACTIONS OFF;
      SET NOCOUNT ON;
      INSERT INTO [ScanResults] ([CardId], [DeviceInfo], [IpAddress], [IssueDetected], [Location], [RelatedIssueId], [Result], [ScanCategory], [ScanContext], [ScanTime], [ScannedBy])
      OUTPUT INSERTED.[Id]
      VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (13ms) [Parameters=[@__p_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[@__cardId_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT [m].[Id], [m].[CardId], [m].[CreatedAt], [m].[CreatedBy], [m].[DueDate], [m].[Notes], [m].[RepeatFrequency], [m].[Title], [m].[UpdatedAt]
      FROM [MaintenanceReminders] AS [m]
      WHERE [m].[CardId] = @__cardId_0
      ORDER BY [m].[DueDate]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (32ms) [Parameters=[@__cardId_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[CardId], [c].[Description], [c].[DocumentType], [c].[FileName], [c].[FilePath], [c].[FileSize], [c].[FileType], [c].[Title], [c].[UploadedAt], [c].[UploadedBy]
      FROM [CardDocuments] AS [c]
      WHERE [c].[CardId] = @__cardId_0
      ORDER BY [c].[UploadedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (13ms) [Parameters=[@__cardId_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT [i].[Id], [i].[CardId], [i].[CreatedAt], [i].[Description], [i].[ImagePath], [i].[IssueType], [i].[Priority], [i].[ReportDate], [i].[ReporterEmail], [i].[ReporterName], [i].[ReporterPhone], [i].[Resolution], [i].[ResolvedAt], [i].[Status]
      FROM [IssueReports] AS [i]
      WHERE [i].[CardId] = @__cardId_0
      ORDER BY [i].[ReportDate] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (508ms) [Parameters=[@p0='11', @p1='Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 | "Windows"' (Nullable = false) (Size = 255), @p2='::1' (Nullable = false) (Size = 100), @p3='False', @p4='https://localhost:44389/Card/ScanShow/11?preview=true&field=product_name&field=category&field=location&field=image&field=custom_%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%AA%E0%B8%B4%E0%B8%99%E0%B8%84%E0%B9%89%E0%B8%B2&field=custom_%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%9C%E0%B8%B4%E0%B8%94%E0%B8%8A%E0%B8%AD%E0%B8%9A&field=custom_%E0%B8%A3%E0%B8%B2%E0%B8%84%E0%B8%B2&field=custom_%E0%B9%81%E0%B8%9C%E0%B8%99%E0%B8%81&field=documents&ui=hide_report_issue&ui=hide_contact&ui=hide_product_details&ui=hide_contact_support&ui=hide_maintenance_history&t=1743061250317' (Nullable = false) (Size = 4000), @p5=NULL (DbType = Int32), @p6='Success' (Nullable = false) (Size = 50), @p7='Regular' (Nullable = false) (Size = 50), @p8='' (Nullable = false) (Size = 100), @p9='2025-03-27T14:40:51.0965693+07:00', @p10='admin' (Nullable = false) (Size = 50)], CommandType='Text', CommandTimeout='120']
      SET IMPLICIT_TRANSACTIONS OFF;
      SET NOCOUNT ON;
      INSERT INTO [ScanResults] ([CardId], [DeviceInfo], [IpAddress], [IssueDetected], [Location], [RelatedIssueId], [Result], [ScanCategory], [ScanContext], [ScanTime], [ScannedBy])
      OUTPUT INSERTED.[Id]
      VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
fail: Microsoft.EntityFrameworkCore.Update[10000]
      An exception occurred in the database while saving changes for context type 'CardTagManager.Data.ApplicationDbContext'.
      Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
       ---> Microsoft.Data.SqlClient.SqlException (0x80131904): String or binary data would be truncated.
         at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
         at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
         at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
         at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
         at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
         at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
         at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
         at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
      --- End of stack trace from previous location ---
         at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
      ClientConnectionId:1cbb62d7-4489-4918-98a8-0b28b0818d95
      Error Number:8152,State:13,Class:16
         --- End of inner exception stack trace ---
         at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
      --- End of stack trace from previous location ---
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
      Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
       ---> Microsoft.Data.SqlClient.SqlException (0x80131904): String or binary data would be truncated.
         at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
         at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
         at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
         at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
         at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
         at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
         at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
         at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
      --- End of stack trace from previous location ---
         at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
      ClientConnectionId:1cbb62d7-4489-4918-98a8-0b28b0818d95
      Error Number:8152,State:13,Class:16
         --- End of inner exception stack trace ---
         at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
      --- End of stack trace from previous location ---
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[@__username_0='admin' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      ORDER BY [c].[UpdatedAt] DESC
fail: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware[1]
      An unhandled exception has occurred while executing the request.
      Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
       ---> Microsoft.Data.SqlClient.SqlException (0x80131904): String or binary data would be truncated.
         at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
         at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
         at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
         at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
         at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
         at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
         at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
         at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
      --- End of stack trace from previous location ---
         at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
      ClientConnectionId:1cbb62d7-4489-4918-98a8-0b28b0818d95
      Error Number:8152,State:13,Class:16
         --- End of inner exception stack trace ---
         at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
      --- End of stack trace from previous location ---
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
         at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
         at CardTagManager.Controllers.CardController.ScanShow(Int32 id) in C:\Users\panupol\Desktop\TagCardQR\Controllers\CardController.cs:line 364
         at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
         at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
         at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
         at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
         at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
[LOGIN] Authenticating user: Panupol
[LOGIN] Authentication result: True, UserCode: 
[LOGIN] Extracted UserCode from Description: 1670660
[LOGIN] Fetching API data for UserCode: 1670660
[API-REQUEST] Fetching user data from: https://devsever.thaiparker.co.th/E2E/api/Get/GetUser?userCode=1670660
[API-RESPONSE] Status: OK
[API-DATA] Raw response: {"System_Prefix_EN":{"Prefix_EN_Id":1,"Prefix_EN_Name":"Mr."},"System_Prefix_TH":{"Prefix_TH_Id":1,"Prefix_TH_Name":"???"},"Users":{"Master_Grades":{"Master_LineWorks":{"System_Authorize":{"Authorize_Id":3,"Authorize_Name":"Requestor"},"Active":true,"Authorize_Id":3,"Create":"2022-07-15T17:48:18.613","LineWork_Id":"21e93366-0b78-4ec8-a167-cb168c8b2dee","LineWork_Name":"E-Engineering","Update":"2022-10-18T09:48:11.397"},"Active":true,"Create":"2022-07-15T17:48:18.723","Grade_Id":"61d4d78b-afda-480b-8348-f6763ec73fe7","Grade_Name":"E8","Grade_Position":"Engineer","LineWork_Id":"21e93366-0b78-4ec8-a167-cb168c8b2dee","Update":null},"Master_Plants":{"Active":true,"Create":"2022-07-15T17:48:18.747","Plant_Id":"e359dc4c-c6d3-4187-9933-e1bd2b1edcf2","Plant_Name":"Bangpoo12","Update":"2023-06-02T12:15:09.447"},"Master_Processes":{"Master_Sections":{"Master_Departments":{"Master_Divisions":{"Active":true,"Create":"2022-07-15T17:48:18.773","Division_Id":"41b85ba6-267b-4c83-a458-903ca25938af","Division_Name":"Administrative","Update":null},"Active":true,"Create":"2022-07-15T17:48:18.797","Department_Id":"c5632bc7-d9a0-4518-9ad9-e086f09f406d","Department_Name":"Information Technology","Division_Id":"41b85ba6-267b-4c83-a458-903ca25938af","Update":null},"Active":true,"Create":"2022-07-15T17:48:18.82","Department_Id":"c5632bc7-d9a0-4518-9ad9-e086f09f406d","Section_Id":"96ec5f53-0e4c-45da-9b27-301b5f9e3c88","Section_Name":"SAP & Application","Update":null},"Active":true,"Create":"2022-07-15T17:48:18.843","Process_Id":"19e4ca4a-66cd-44fb-bd58-ffed7f1deead","Process_Name":"Information Technology Bangpoo","Section_Id":"96ec5f53-0e4c-45da-9b27-301b5f9e3c88","Update":null},"System_Roles":{"Role_Id":2,"Role_Name":"User"},"Active":true,"BusinessCardGroup":false,"Create":"2024-11-14T14:42:47.693","Grade_Id":"61d4d78b-afda-480b-8348-f6763ec73fe7","Plant_Id":"e359dc4c-c6d3-4187-9933-e1bd2b1edcf2","Process_Id":"19e4ca4a-66cd-44fb-bd58-ffed7f1deead","Role_Id":2,"Update":"2025-03-27T10:30:39.47","User_Code":"1670660","User_CostCenter":"41100","User_Email":"Panupol@thaiparker.co.th","User_Id":"31debf3e-dffc-4600-aecf-8f7e2ce85000","User_Point":50,"Username":"Panupol","YearSetPoint":2025},"Detail_ConfirmPassword":null,"Detail_EN_FirstName":"Panupol","Detail_EN_LastName":"Sonnuam","Detail_Password":null,"Detail_TH_FirstName":"??????","Detail_TH_LastName":"???????","Prefix_EN_Id":1,"Prefix_TH_Id":1,"User_Id":"31debf3e-dffc-4600-aecf-8f7e2ce85000"}
[API-PARSE] Line-by-line analysis:
[API-FIELD] {"System_Prefix_EN":{"Prefix_EN_Id":1,"Prefix_EN_Name":"Mr."},"System_Prefix_TH":{"Prefix_TH_Id":1,"Prefix_TH_Name":"???"},"Users":{"Master_Grades":{"Master_LineWorks":{"System_Authorize":{"Authorize_Id":3,"Authorize_Name":"Requestor"},"Active":true,"Authorize_Id":3,"Create":"2022-07-15T17:48:18.613","LineWork_Id":"21e93366-0b78-4ec8-a167-cb168c8b2dee","LineWork_Name":"E-Engineering","Update":"2022-10-18T09:48:11.397"},"Active":true,"Create":"2022-07-15T17:48:18.723","Grade_Id":"61d4d78b-afda-480b-8348-f6763ec73fe7","Grade_Name":"E8","Grade_Position":"Engineer","LineWork_Id":"21e93366-0b78-4ec8-a167-cb168c8b2dee","Update":null},"Master_Plants":{"Active":true,"Create":"2022-07-15T17:48:18.747","Plant_Id":"e359dc4c-c6d3-4187-9933-e1bd2b1edcf2","Plant_Name":"Bangpoo12","Update":"2023-06-02T12:15:09.447"},"Master_Processes":{"Master_Sections":{"Master_Departments":{"Master_Divisions":{"Active":true,"Create":"2022-07-15T17:48:18.773","Division_Id":"41b85ba6-267b-4c83-a458-903ca25938af","Division_Name":"Administrative","Update":null},"Active":true,"Create":"2022-07-15T17:48:18.797","Department_Id":"c5632bc7-d9a0-4518-9ad9-e086f09f406d","Department_Name":"Information Technology","Division_Id":"41b85ba6-267b-4c83-a458-903ca25938af","Update":null},"Active":true,"Create":"2022-07-15T17:48:18.82","Department_Id":"c5632bc7-d9a0-4518-9ad9-e086f09f406d","Section_Id":"96ec5f53-0e4c-45da-9b27-301b5f9e3c88","Section_Name":"SAP & Application","Update":null},"Active":true,"Create":"2022-07-15T17:48:18.843","Process_Id":"19e4ca4a-66cd-44fb-bd58-ffed7f1deead","Process_Name":"Information Technology Bangpoo","Section_Id":"96ec5f53-0e4c-45da-9b27-301b5f9e3c88","Update":null},"System_Roles":{"Role_Id":2,"Role_Name":"User"},"Active":true,"BusinessCardGroup":false,"Create":"2024-11-14T14:42:47.693","Grade_Id":"61d4d78b-afda-480b-8348-f6763ec73fe7","Plant_Id":"e359dc4c-c6d3-4187-9933-e1bd2b1edcf2","Process_Id":"19e4ca4a-66cd-44fb-bd58-ffed7f1deead","Role_Id":2,"Update":"2025-03-27T10:30:39.47","User_Code":"1670660","User_CostCenter":"41100","User_Email":"Panupol@thaiparker.co.th","User_Id":"31debf3e-dffc-4600-aecf-8f7e2ce85000","User_Point":50,"Username":"Panupol","YearSetPoint":2025},"Detail_ConfirmPassword":null,"Detail_EN_FirstName":"Panupol","Detail_EN_LastName":"Sonnuam","Detail_Password":null,"Detail_TH_FirstName":"??????","Detail_TH_LastName":"???????","Prefix_EN_Id":1,"Prefix_TH_Id":1,"User_Id":"31debf3e-dffc-4600-aecf-8f7e2ce85000"}
[API-EXTRACT] Regex extraction results:
[API-FOUND] Detail_TH_FirstName: ??????
[API-FOUND] Detail_TH_LastName: ???????
[API-FOUND] Detail_EN_FirstName: Panupol
[API-FOUND] Detail_EN_LastName: Sonnuam
[API-FOUND] Plant_Name: Bangpoo12
[API-FOUND] Department_Name: Information Technology
[API-FOUND] User_Code: 1670660
[API-FOUND] User_Email: Panupol@thaiparker.co.th
[API-JSON] Attempting JsonDocument parse
[API-JSON] Root element properties: System_Prefix_EN, System_Prefix_TH, Users, Detail_ConfirmPassword, Detail_EN_FirstName, Detail_EN_LastName, Detail_Password, Detail_TH_FirstName, Detail_TH_LastName, Prefix_EN_Id, Prefix_TH_Id, User_Id
[API-JSON-PROP] System_Prefix_EN.Prefix_EN_Id: 1
[API-JSON-PROP] System_Prefix_EN.Prefix_EN_Name: Mr.
[API-JSON-PROP] System_Prefix_TH.Prefix_TH_Id: 1
[API-JSON-PROP] System_Prefix_TH.Prefix_TH_Name: ???
[API-JSON-PROP] Users.Master_Grades.Master_LineWorks.System_Authorize.Authorize_Id: 3
[API-JSON-PROP] Users.Master_Grades.Master_LineWorks.System_Authorize.Authorize_Name: Requestor
[API-JSON-PROP] Users.Master_Grades.Master_LineWorks.Active: True
[API-JSON-PROP] Users.Master_Grades.Master_LineWorks.Authorize_Id: 3
[API-JSON-PROP] Users.Master_Grades.Master_LineWorks.Create: 2022-07-15T17:48:18.613
[API-JSON-PROP] Users.Master_Grades.Master_LineWorks.LineWork_Id: 21e93366-0b78-4ec8-a167-cb168c8b2dee
[API-JSON-PROP] Users.Master_Grades.Master_LineWorks.LineWork_Name: E-Engineering
[API-JSON-PROP] Users.Master_Grades.Master_LineWorks.Update: 2022-10-18T09:48:11.397
[API-JSON-PROP] Users.Master_Grades.Active: True
[API-JSON-PROP] Users.Master_Grades.Create: 2022-07-15T17:48:18.723
[API-JSON-PROP] Users.Master_Grades.Grade_Id: 61d4d78b-afda-480b-8348-f6763ec73fe7
[API-JSON-PROP] Users.Master_Grades.Grade_Name: E8
[API-JSON-PROP] Users.Master_Grades.Grade_Position: Engineer
[API-JSON-PROP] Users.Master_Grades.LineWork_Id: 21e93366-0b78-4ec8-a167-cb168c8b2dee
[API-JSON-PROP] Users.Master_Plants.Active: True
[API-JSON-PROP] Users.Master_Plants.Create: 2022-07-15T17:48:18.747
[API-JSON-PROP] Users.Master_Plants.Plant_Id: e359dc4c-c6d3-4187-9933-e1bd2b1edcf2
[API-JSON-PROP] Users.Master_Plants.Plant_Name: Bangpoo12
[API-JSON-PROP] Users.Master_Plants.Update: 2023-06-02T12:15:09.447
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Master_Departments.Master_Divisions.Active: True
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Master_Departments.Master_Divisions.Create: 2022-07-15T17:48:18.773
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Master_Departments.Master_Divisions.Division_Id: 41b85ba6-267b-4c83-a458-903ca25938af
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Master_Departments.Master_Divisions.Division_Name: Administrative
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Master_Departments.Active: True
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Master_Departments.Create: 2022-07-15T17:48:18.797
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Master_Departments.Department_Id: c5632bc7-d9a0-4518-9ad9-e086f09f406d
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Master_Departments.Department_Name: Information Technology
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Master_Departments.Division_Id: 41b85ba6-267b-4c83-a458-903ca25938af
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Active: True
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Create: 2022-07-15T17:48:18.82
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Department_Id: c5632bc7-d9a0-4518-9ad9-e086f09f406d
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Section_Id: 96ec5f53-0e4c-45da-9b27-301b5f9e3c88
[API-JSON-PROP] Users.Master_Processes.Master_Sections.Section_Name: SAP & Application
[API-JSON-PROP] Users.Master_Processes.Active: True
[API-JSON-PROP] Users.Master_Processes.Create: 2022-07-15T17:48:18.843
[API-JSON-PROP] Users.Master_Processes.Process_Id: 19e4ca4a-66cd-44fb-bd58-ffed7f1deead
[API-JSON-PROP] Users.Master_Processes.Process_Name: Information Technology Bangpoo
[API-JSON-PROP] Users.Master_Processes.Section_Id: 96ec5f53-0e4c-45da-9b27-301b5f9e3c88
[API-JSON-PROP] Users.System_Roles.Role_Id: 2
[API-JSON-PROP] Users.System_Roles.Role_Name: User
[API-JSON-PROP] Users.Active: True
[API-JSON-PROP] Users.BusinessCardGroup: False
[API-JSON-PROP] Users.Create: 2024-11-14T14:42:47.693
[API-JSON-PROP] Users.Grade_Id: 61d4d78b-afda-480b-8348-f6763ec73fe7
[API-JSON-PROP] Users.Plant_Id: e359dc4c-c6d3-4187-9933-e1bd2b1edcf2
[API-JSON-PROP] Users.Process_Id: 19e4ca4a-66cd-44fb-bd58-ffed7f1deead
[API-JSON-PROP] Users.Role_Id: 2
[API-JSON-PROP] Users.Update: 2025-03-27T10:30:39.47
[API-JSON-PROP] Users.User_Code: 1670660
[API-JSON-PROP] Users.User_CostCenter: 41100
[API-JSON-PROP] Users.User_Email: Panupol@thaiparker.co.th
[API-JSON-PROP] Users.User_Id: 31debf3e-dffc-4600-aecf-8f7e2ce85000
[API-JSON-PROP] Users.User_Point: 50
[API-JSON-PROP] Users.Username: Panupol
[API-JSON-PROP] Users.YearSetPoint: 2025
[API-JSON-PROP] Detail_EN_FirstName: Panupol
[API-JSON-PROP] Detail_EN_LastName: Sonnuam
[API-JSON-PROP] Detail_TH_FirstName: ??????
[API-JSON-PROP] Detail_TH_LastName: ???????
[API-JSON-PROP] Prefix_EN_Id: 1
[API-JSON-PROP] Prefix_TH_Id: 1
[API-JSON-PROP] User_Id: 31debf3e-dffc-4600-aecf-8f7e2ce85000
[API-RESULTS] Final extracted values:
UserCode: 1670660
ThaiFirstName: ??????
ThaiLastName: ???????
EnglishFirstName: Panupol
EnglishLastName: Sonnuam
Department: Information Technology
PlantName: Bangpoo12
Email: Panupol@thaiparker.co.th
info: CardTagManager.Controllers.AccountController[0]
      Checking for existing user with email: Panupol@thaiparker.co.th
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (12ms) [Parameters=[@__email_0='Panupol@thaiparker.co.th' (Size = 255)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[User_Email] = @__email_0 AND [u].[User_Email] NOT LIKE N''
[LOGIN] Creating/updating profile with TH: ?????? ???????
info: CardTagManager.Services.UserProfileService[0]
      Creating/updating profile for Panupol
info: CardTagManager.Services.UserProfileService[0]
      TH: ?????? ???????, Plant: Bangpoo12, UserCode: 1670660
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: CardTagManager.Services.UserProfileService[0]
      Saving profile with TH names: ?????? ???????, Plant: Bangpoo12, UserCode: 1670660
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[@p1='19', @p0='2025-03-27T14:41:55.0946611+07:00'], CommandType='Text', CommandTimeout='120']
      SET IMPLICIT_TRANSACTIONS OFF;
      SET NOCOUNT ON;
      UPDATE [UserProfiles] SET [LastLoginAt] = @p0
      OUTPUT 1
      WHERE [Id] = @p1;
[DB-UPDATE] Updating profile for Panupol
[DB-UPDATE] TH: ?????? ???????
[DB-UPDATE] EN: Panupol Sonnuam
[DB-UPDATE] Plant: Bangpoo12, Dept: Information Technology
[DB-UPDATE] Code: 1670660, Email: Panupol@thaiparker.co.th
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
[DB-UPDATE] Current DB values:
[DB-UPDATE] DB TH: ?????? ???????
[DB-UPDATE] DB Plant: Bangpoo12, Dept: Information Technology
[DB-UPDATE] Executing SQL update
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (514ms) [Parameters=[@thaiFirstName='??????' (Nullable = false) (Size = 6), @thaiLastName='???????' (Nullable = false) (Size = 7), @enFirstName='Panupol' (Nullable = false) (Size = 7), @enLastName='Sonnuam' (Nullable = false) (Size = 7), @plantName='Bangpoo12' (Nullable = false) (Size = 9), @userCode='1670660' (Nullable = false) (Size = 7), @department='Information Technology' (Nullable = false) (Size = 22), @email='Panupol@thaiparker.co.th' (Nullable = false) (Size = 24), @lastLogin='2025-03-27T14:41:55.1201254+07:00' (DbType = DateTime), @username='Panupol' (Nullable = false) (Size = 7)], CommandType='Text', CommandTimeout='120']
      
                          UPDATE UserProfiles 
                          SET Detail_TH_FirstName = @thaiFirstName,
                              Detail_TH_LastName = @thaiLastName,
                              Detail_EN_FirstName = @enFirstName,
                              Detail_EN_LastName = @enLastName,
                              Plant_Name = @plantName,
                              User_Code = @userCode,
                              Department_Name = @department,
                              User_Email = @email,
                              LastLoginAt = @lastLogin
                          WHERE Username = @username
[DB-UPDATE] Rows affected: 1
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
[DB-UPDATE] Updated values:
[DB-UPDATE] Updated TH: ?????? ???????
[DB-UPDATE] Updated Plant: Bangpoo12, Dept: Information Technology
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[@__userId_0='19'], CommandType='Text', CommandTimeout='120']
      SELECT [r].[Id], [r].[ConcurrencyStamp], [r].[CreatedAt], [r].[Description], [r].[Name], [r].[NormalizedName], [r].[UpdatedAt]
      FROM [UserRoles] AS [u]
      INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
      WHERE [u].[UserId] = @__userId_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__userId_0='19'], CommandType='Text', CommandTimeout='120']
      SELECT [d].[DepartmentName]
      FROM [DepartmentAccesses] AS [d]
      WHERE [d].[UserId] = @__userId_0 AND [d].[IsActive] = CAST(1 AS bit)
info: CardTagManager.Controllers.CardController[0]
      User Panupol has access to departments: IT Department, Information Technology
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[p0='IT Department' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (15ms) [Parameters=[p0='Information Technology' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='120']
      SELECT [t0].[Category]
      FROM (
          SELECT DISTINCT [t].[Category]
          FROM [Templates] AS [t]
      ) AS [t0]
      ORDER BY [t0].[Category]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[@__userDepartment_0='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT [t].[Id], [t].[BgColor], [t].[Category], [t].[CreatedAt], [t].[CreatedBy], [t].[CreatedByID], [t].[FieldsJson], [t].[Icon], [t].[IconColor], [t].[Name], [t].[UpdatedAt], [t].[UpdatedBy], [t].[UpdatedByID]
      FROM [Templates] AS [t]
      INNER JOIN [UserProfiles] AS [u] ON [t].[CreatedByID] = [u].[User_Code]
      WHERE [u].[Department_Name] = @__userDepartment_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[@__userDepartment_0='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
      WHERE [u].[Department_Name] = @__userDepartment_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__userId_0='19'], CommandType='Text', CommandTimeout='120']
      SELECT [d].[DepartmentName]
      FROM [DepartmentAccesses] AS [d]
      WHERE [d].[UserId] = @__userId_0 AND [d].[IsActive] = CAST(1 AS bit)
info: CardTagManager.Controllers.CardController[0]
      User Panupol has access to departments: IT Department, Information Technology
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (12ms) [Parameters=[p0='IT Department' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[p0='Information Technology' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (506ms) [Parameters=[@__p_1='100', @__userDepartment_0='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT [s0].[Id], [s0].[CardId], [c0].[ProductName] AS [CardName], [s0].[ScanTime], [s0].[DeviceInfo], [s0].[Location], [s0].[Result] AS [ScanResult]
      FROM (
          SELECT TOP(@__p_1) [s].[Id], [s].[CardId], [s].[DeviceInfo], [s].[Location], [s].[Result], [s].[ScanTime]
          FROM [ScanResults] AS [s]
          INNER JOIN [Cards] AS [c] ON [s].[CardId] = [c].[Id]
          INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
          WHERE [u].[Department_Name] = @__userDepartment_0
          ORDER BY [s].[ScanTime] DESC
      ) AS [s0]
      INNER JOIN [Cards] AS [c0] ON [s0].[CardId] = [c0].[Id]
      ORDER BY [s0].[ScanTime] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[@__userId_0='19'], CommandType='Text', CommandTimeout='120']
      SELECT [d].[DepartmentName]
      FROM [DepartmentAccesses] AS [d]
      WHERE [d].[UserId] = @__userId_0 AND [d].[IsActive] = CAST(1 AS bit)
info: CardTagManager.Controllers.CardController[0]
      User Panupol has access to departments: IT Department, Information Technology
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[p0='IT Department' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[p0='Information Technology' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (60ms) [Parameters=[@__p_0='15'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__p_0='15'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (505ms) [Parameters=[@p0='15', @p1='Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 | "Windows"' (Nullable = false) (Size = 255), @p2='::1' (Nullable = false) (Size = 100), @p3='False', @p4='https://localhost:44389/Card/QrCode/15' (Nullable = false) (Size = 255), @p5=NULL (DbType = Int32), @p6='Success' (Nullable = false) (Size = 50), @p7='Regular' (Nullable = false) (Size = 50), @p8='' (Nullable = false) (Size = 100), @p9='2025-03-27T14:42:25.9265902+07:00', @p10='Panupol' (Nullable = false) (Size = 50)], CommandType='Text', CommandTimeout='120']
      SET IMPLICIT_TRANSACTIONS OFF;
      SET NOCOUNT ON;
      INSERT INTO [ScanResults] ([CardId], [DeviceInfo], [IpAddress], [IssueDetected], [Location], [RelatedIssueId], [Result], [ScanCategory], [ScanContext], [ScanTime], [ScannedBy])
      OUTPUT INSERTED.[Id]
      VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (17ms) [Parameters=[@__p_0='15'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__cardId_0='15'], CommandType='Text', CommandTimeout='120']
      SELECT [m].[Id], [m].[CardId], [m].[CreatedAt], [m].[CreatedBy], [m].[DueDate], [m].[Notes], [m].[RepeatFrequency], [m].[Title], [m].[UpdatedAt]
      FROM [MaintenanceReminders] AS [m]
      WHERE [m].[CardId] = @__cardId_0
      ORDER BY [m].[DueDate]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (38ms) [Parameters=[@__cardId_0='15'], CommandType='Text', CommandTimeout='120']
      SELECT [i].[Id], [i].[CardId], [i].[CreatedAt], [i].[Description], [i].[ImagePath], [i].[IssueType], [i].[Priority], [i].[ReportDate], [i].[ReporterEmail], [i].[ReporterName], [i].[ReporterPhone], [i].[Resolution], [i].[ResolvedAt], [i].[Status]
      FROM [IssueReports] AS [i]
      WHERE [i].[CardId] = @__cardId_0
      ORDER BY [i].[ReportDate] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[@__cardId_0='15'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [s].[Id], [s].[CardId], [s].[CreatedAt], [s].[CreatedBy], [s].[FieldsJson], [s].[PrivateMode], [s].[UiElementsJson], [s].[UpdatedAt]
      FROM [ScanSettings] AS [s]
      WHERE [s].[CardId] = @__cardId_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__cardId_0='15'], CommandType='Text', CommandTimeout='120']
      SELECT [c].[Id], [c].[CardId], [c].[Description], [c].[DocumentType], [c].[FileName], [c].[FilePath], [c].[FileSize], [c].[FileType], [c].[Title], [c].[UploadedAt], [c].[UploadedBy]
      FROM [CardDocuments] AS [c]
      WHERE [c].[CardId] = @__cardId_0
      ORDER BY [c].[UploadedAt] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (507ms) [Parameters=[@p0='15', @p1='Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 | "Windows"' (Nullable = false) (Size = 255), @p2='::1' (Nullable = false) (Size = 100), @p3='False', @p4='https://localhost:44389/Card/ScanShow/15' (Nullable = false) (Size = 255), @p5=NULL (DbType = Int32), @p6='Success' (Nullable = false) (Size = 50), @p7='Regular' (Nullable = false) (Size = 50), @p8='' (Nullable = false) (Size = 100), @p9='2025-03-27T14:42:26.5325943+07:00', @p10='Panupol' (Nullable = false) (Size = 50)], CommandType='Text', CommandTimeout='120']
      SET IMPLICIT_TRANSACTIONS OFF;
      SET NOCOUNT ON;
      INSERT INTO [ScanResults] ([CardId], [DeviceInfo], [IpAddress], [IssueDetected], [Location], [RelatedIssueId], [Result], [ScanCategory], [ScanContext], [ScanTime], [ScannedBy])
      OUTPUT INSERTED.[Id]
      VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (12ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[@__userId_0='19'], CommandType='Text', CommandTimeout='120']
      SELECT [d].[DepartmentName]
      FROM [DepartmentAccesses] AS [d]
      WHERE [d].[UserId] = @__userId_0 AND [d].[IsActive] = CAST(1 AS bit)
info: CardTagManager.Controllers.CardController[0]
      User Panupol has access to departments: IT Department, Information Technology
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[p0='IT Department' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (16ms) [Parameters=[p0='Information Technology' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (507ms) [Parameters=[@__p_1='100', @__userDepartment_0='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT [s0].[Id], [s0].[CardId], [c0].[ProductName] AS [CardName], [s0].[ScanTime], [s0].[DeviceInfo], [s0].[Location], [s0].[Result] AS [ScanResult]
      FROM (
          SELECT TOP(@__p_1) [s].[Id], [s].[CardId], [s].[DeviceInfo], [s].[Location], [s].[Result], [s].[ScanTime]
          FROM [ScanResults] AS [s]
          INNER JOIN [Cards] AS [c] ON [s].[CardId] = [c].[Id]
          INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
          WHERE [u].[Department_Name] = @__userDepartment_0
          ORDER BY [s].[ScanTime] DESC
      ) AS [s0]
      INNER JOIN [Cards] AS [c0] ON [s0].[CardId] = [c0].[Id]
      ORDER BY [s0].[ScanTime] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (512ms) [Parameters=[@__p_1='100', @__userDepartment_0='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT [s0].[Id], [s0].[CardId], [c0].[ProductName] AS [CardName], [s0].[ScanTime], [s0].[DeviceInfo], [s0].[Location], [s0].[Result] AS [ScanResult]
      FROM (
          SELECT TOP(@__p_1) [s].[Id], [s].[CardId], [s].[DeviceInfo], [s].[Location], [s].[Result], [s].[ScanTime]
          FROM [ScanResults] AS [s]
          INNER JOIN [Cards] AS [c] ON [s].[CardId] = [c].[Id]
          INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
          WHERE [u].[Department_Name] = @__userDepartment_0
          ORDER BY [s].[ScanTime] DESC
      ) AS [s0]
      INNER JOIN [Cards] AS [c0] ON [s0].[CardId] = [c0].[Id]
      ORDER BY [s0].[ScanTime] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (511ms) [Parameters=[@__p_1='100', @__userDepartment_0='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT [s].[Id] AS [id], [s].[CardId] AS [cardId], [c0].[ProductName] AS [cardName], [s].[Status] AS [status], [s].[Priority] AS [priority], [s].[IssueType] AS [issueType], [s].[Description] AS [description], [s].[ReportDate] AS [reportDate], [s].[ReporterName] AS [reporterName], [s].[ReporterEmail] AS [reporterEmail], [s].[Resolution] AS [resolution], [s].[ResolvedAt] AS [resolvedAt]
      FROM (
          SELECT TOP(@__p_1) [i].[Id], [i].[CardId], [i].[Description], [i].[IssueType], [i].[Priority], [i].[ReportDate], [i].[ReporterEmail], [i].[ReporterName], [i].[Resolution], [i].[ResolvedAt], [i].[Status]
          FROM [IssueReports] AS [i]
          INNER JOIN [Cards] AS [c] ON [i].[CardId] = [c].[Id]
          INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
          WHERE [u].[Department_Name] = @__userDepartment_0
          ORDER BY [i].[ReportDate] DESC
      ) AS [s]
      INNER JOIN [Cards] AS [c0] ON [s].[CardId] = [c0].[Id]
      ORDER BY [s].[ReportDate] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[@__startDate_0='2025-03-20T14:42:46.1149135+07:00', @__endDate_1='2025-03-27T14:42:46.1149135+07:00', @__userDepartment_2='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT [s].[Id], [s].[CardId], [s].[DeviceInfo], [s].[IpAddress], [s].[IssueDetected], [s].[Location], [s].[RelatedIssueId], [s].[Result], [s].[ScanCategory], [s].[ScanContext], [s].[ScanTime], [s].[ScannedBy]
      FROM [ScanResults] AS [s]
      INNER JOIN [Cards] AS [c] ON [s].[CardId] = [c].[Id]
      INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
      WHERE [s].[ScanTime] >= @__startDate_0 AND [s].[ScanTime] <= @__endDate_1 AND [u].[Department_Name] = @__userDepartment_2
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (9ms) [Parameters=[@__userDepartment_0='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT [i].[Status] AS [status], COUNT(*) AS [count]
      FROM [IssueReports] AS [i]
      INNER JOIN [Cards] AS [c] ON [i].[CardId] = [c].[Id]
      INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
      WHERE [u].[Department_Name] = @__userDepartment_0
      GROUP BY [i].[Status]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[@__userDepartment_0='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT [i].[Priority] AS [priority], COUNT(*) AS [count]
      FROM [IssueReports] AS [i]
      INNER JOIN [Cards] AS [c] ON [i].[CardId] = [c].[Id]
      INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
      WHERE [u].[Department_Name] = @__userDepartment_0
      GROUP BY [i].[Priority]
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (523ms) [Parameters=[@__p_1='10', @__userDepartment_0='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(@__p_1) [i].[CardId] AS [cardId], (
          SELECT TOP(1) [c1].[ProductName]
          FROM [IssueReports] AS [i0]
          INNER JOIN [Cards] AS [c0] ON [i0].[CardId] = [c0].[Id]
          INNER JOIN [UserProfiles] AS [u0] ON [c0].[CreatedByID] = [u0].[User_Code]
          INNER JOIN [Cards] AS [c1] ON [i0].[CardId] = [c1].[Id]
          WHERE [u0].[Department_Name] = @__userDepartment_0 AND [i].[CardId] = [i0].[CardId]) AS [productName], COUNT(*) AS [totalIssues], COUNT(CASE
          WHEN [i].[Status] IN (N'Open', N'In Progress') THEN 1
      END) AS [openIssues], COALESCE((
          SELECT TOP(1) [i1].[IssueType]
          FROM [IssueReports] AS [i1]
          INNER JOIN [Cards] AS [c2] ON [i1].[CardId] = [c2].[Id]
          INNER JOIN [UserProfiles] AS [u1] ON [c2].[CreatedByID] = [u1].[User_Code]
          WHERE [u1].[Department_Name] = @__userDepartment_0 AND [i].[CardId] = [i1].[CardId]
          GROUP BY [i1].[IssueType]
          ORDER BY COUNT(*) DESC), N'Unknown') AS [commonIssue], MAX([i].[ReportDate]) AS [lastReported]
      FROM [IssueReports] AS [i]
      INNER JOIN [Cards] AS [c] ON [i].[CardId] = [c].[Id]
      INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
      WHERE [u].[Department_Name] = @__userDepartment_0
      GROUP BY [i].[CardId]
      ORDER BY COUNT(*) DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (506ms) [Parameters=[@__p_1='100', @__userDepartment_0='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT [s].[Id] AS [id], [s].[CardId] AS [cardId], [c0].[ProductName] AS [cardName], [s].[Status] AS [status], [s].[Priority] AS [priority], [s].[IssueType] AS [issueType], [s].[Description] AS [description], [s].[ReportDate] AS [reportDate], [s].[ReporterName] AS [reporterName], [s].[ReporterEmail] AS [reporterEmail], [s].[Resolution] AS [resolution], [s].[ResolvedAt] AS [resolvedAt]
      FROM (
          SELECT TOP(@__p_1) [i].[Id], [i].[CardId], [i].[Description], [i].[IssueType], [i].[Priority], [i].[ReportDate], [i].[ReporterEmail], [i].[ReporterName], [i].[Resolution], [i].[ResolvedAt], [i].[Status]
          FROM [IssueReports] AS [i]
          INNER JOIN [Cards] AS [c] ON [i].[CardId] = [c].[Id]
          INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
          WHERE [u].[Department_Name] = @__userDepartment_0
          ORDER BY [i].[ReportDate] DESC
      ) AS [s]
      INNER JOIN [Cards] AS [c0] ON [s].[CardId] = [c0].[Id]
      ORDER BY [s].[ReportDate] DESC
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__userId_0='19'], CommandType='Text', CommandTimeout='120']
      SELECT [d].[DepartmentName]
      FROM [DepartmentAccesses] AS [d]
      WHERE [d].[UserId] = @__userId_0 AND [d].[IsActive] = CAST(1 AS bit)
info: CardTagManager.Controllers.CardController[0]
      User Panupol has access to departments: IT Department, Information Technology
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (5ms) [Parameters=[p0='IT Department' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[p0='Information Technology' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__p_0='13'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[@__8__locals1_id_0='13', @__userDepartment_1='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT CASE
          WHEN EXISTS (
              SELECT 1
              FROM [Cards] AS [c]
              INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
              WHERE [c].[Id] = @__8__locals1_id_0 AND [u].[Department_Name] = @__userDepartment_1) THEN CAST(1 AS bit)
          ELSE CAST(0 AS bit)
      END
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__userId_0='19'], CommandType='Text', CommandTimeout='120']
      SELECT [d].[DepartmentName]
      FROM [DepartmentAccesses] AS [d]
      WHERE [d].[UserId] = @__userId_0 AND [d].[IsActive] = CAST(1 AS bit)
info: CardTagManager.Controllers.CardController[0]
      User Panupol has access to departments: IT Department, Information Technology
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[p0='IT Department' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (10ms) [Parameters=[p0='Information Technology' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[@__p_0='13'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__8__locals1_id_0='13', @__userDepartment_1='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT CASE
          WHEN EXISTS (
              SELECT 1
              FROM [Cards] AS [c]
              INNER JOIN [UserProfiles] AS [u] ON [c].[CreatedByID] = [u].[User_Code]
              WHERE [c].[Id] = @__8__locals1_id_0 AND [u].[Department_Name] = @__userDepartment_1) THEN CAST(1 AS bit)
          ELSE CAST(0 AS bit)
      END
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (10ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (2ms) [Parameters=[@__userId_0='19'], CommandType='Text', CommandTimeout='120']
      SELECT [d].[DepartmentName]
      FROM [DepartmentAccesses] AS [d]
      WHERE [d].[UserId] = @__userId_0 AND [d].[IsActive] = CAST(1 AS bit)
info: CardTagManager.Controllers.CardController[0]
      User Panupol has access to departments: IT Department, Information Technology
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (6ms) [Parameters=[p0='IT Department' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[p0='Information Technology' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__p_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@__username_0='Panupol' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [u].[Id], [u].[Department_Name], [u].[Detail_EN_FirstName], [u].[Detail_EN_LastName], [u].[Detail_TH_FirstName], [u].[Detail_TH_LastName], [u].[FirstLoginAt], [u].[IsActive], [u].[LastLoginAt], [u].[Plant_Name], [u].[User_Code], [u].[User_Email], [u].[Username]
      FROM [UserProfiles] AS [u]
      WHERE [u].[Username] = @__username_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__userId_0='19'], CommandType='Text', CommandTimeout='120']
      SELECT [d].[DepartmentName]
      FROM [DepartmentAccesses] AS [d]
      WHERE [d].[UserId] = @__userId_0 AND [d].[IsActive] = CAST(1 AS bit)
info: CardTagManager.Controllers.CardController[0]
      User Panupol has access to departments: IT Department, Information Technology
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (7ms) [Parameters=[p0='IT Department' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (19ms) [Parameters=[p0='Information Technology' (Size = 4000)], CommandType='Text', CommandTimeout='120']
      
                                      SELECT c.* FROM Cards c
                                      INNER JOIN UserProfiles u ON c.CreatedByID = u.User_Code
                                      WHERE u.Department_Name = @p0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (8ms) [Parameters=[@__p_0='11'], CommandType='Text', CommandTimeout='120']
      SELECT TOP(1) [c].[Id], [c].[AccentColor], [c].[BackgroundColor], [c].[Category], [c].[CreatedAt], [c].[CreatedBy], [c].[CreatedByID], [c].[CustomFieldsData], [c].[ImagePath], [c].[Location], [c].[MaintenanceInfo], [c].[ManufactureDate], [c].[ProductName], [c].[PurchaseDate], [c].[QrBgColor], [c].[QrFgColor], [c].[TextColor], [c].[UpdatedAt], [c].[UpdatedBy], [c].[UpdatedByID], [c].[WarrantyExpiration]
      FROM [Cards] AS [c]
      WHERE [c].[Id] = @__p_0
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@__8__locals1_id_0='11', @__userDepartment_1='Information Technology' (Size = 100)], CommandType='Text', CommandTimeout='120']
      SELECT CASE
          WHEN EXISTS (
              SELECT 1
              F